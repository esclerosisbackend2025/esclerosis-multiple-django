{% extends 'layout_esclerosis.html' %}
{% load static %}

{% block content %}

<div class="container my-5 testimonios-form-section animate-fade-up" style="max-width: 650px;">
  <div class="card shadow-lg border-0 form-card">
    <div class="card-body p-4">

      <!-- -------------------- Título del formulario -------------------- -->
      {% if editar %}
        <h2 class="text-center fw-bold titulo-seccion">Editar Testimonio</h2>
        <p class="text-center texto-intro">Modifica los datos de tu testimonio y guarda los cambios.</p>
      {% else %}
        <h2 class="text-center fw-bold titulo-seccion">Comparte tu Testimonio</h2>
        <p class="text-center texto-intro">
          Tu historia puede inspirar y acompañar a otras personas que viven con Esclerosis Múltiple en Chile.
        </p>
      {% endif %}

      <!-- -------------------- Mensajes -------------------- -->
      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
          </div>
        {% endfor %}
      {% endif %}

      <!-- -------------------- Formulario -------------------- -->
      <form method="POST" novalidate>
        {% csrf_token %}
        
        <!-- Título -->
        <div class="mt-3">
          <label for="id_titulo" class="form-label fw-semibold">Título del testimonio</label>
          {{ form.titulo }}
          {% if form.titulo.errors %}
            <div class="text-danger small">{{ form.titulo.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Nombre y apellido -->
        <div class="row g-3 mt-3">
          <div class="col-md-6">
            <label for="id_nombre" class="form-label fw-semibold">Nombre</label>
            {{ form.nombre }}
            {% if form.nombre.errors %}
              <div class="text-danger small">{{ form.nombre.errors|striptags }}</div>
            {% endif %}
          </div>

          <div class="col-md-6">
            <label for="id_apellido" class="form-label fw-semibold">Apellido</label>
            {{ form.apellido }}
            {% if form.apellido.errors %}
              <div class="text-danger small">{{ form.apellido.errors|striptags }}</div>
            {% endif %}
          </div>
        </div>

        <!-- Correo -->
        <div class="mt-3">
          <label for="id_correo" class="form-label fw-semibold">Correo electrónico</label>
          {{ form.correo }}
          {% if form.correo.errors %}
            <div class="text-danger small">{{ form.correo.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- RUT -->
        <div class="mt-3">
          <label for="id_rut" class="form-label fw-semibold">RUT</label>
          {{ form.rut }}
          {% if form.rut.errors %}
            <div class="text-danger small">{{ form.rut.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Mostrar nombre público -->
        <div class="form-check mt-3">
          {{ form.mostrar_nombre }}
          <label for="id_mostrar_nombre" class="form-check-label">
            Mostrar mi nombre públicamente (dejar sin marcar para publicar como anónimo)
          </label>
        </div>

        <!-- Mensaje -->
        <div class="mt-3">
          <label for="id_mensaje" class="form-label fw-semibold">Tu testimonio</label>
          {{ form.mensaje }}
          {% if form.mensaje.errors %}
            <div class="text-danger small">{{ form.mensaje.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Botón -->
        <div class="text-center mt-4">
          {% if editar %}
            <button type="submit" class="btn btn-hero-calida px-4 py-2 shadow-sm">Guardar cambios</button>
          {% else %}
            <button type="submit" class="btn btn-hero-calida px-4 py-2 shadow-sm">Enviar testimonio</button>
          {% endif %}
        </div>
      </form>

      <p class="text-center text-muted small mt-3 mb-0">
        Tu RUT se usa solo para verificación interna. No será publicado ni compartido.
      </p>

    </div>
  </div>
</div>

<!-- -------------------- Estilos -------------------- -->
<style>
  .testimonios-form-section {
    background: linear-gradient(to bottom, #E6E0C5 0%, #D9D3B3 100%);
    border-radius: 20px;
    box-shadow: 0 6px 25px rgba(0,0,0,0.08);
    padding: 40px 20px;
  }

  .form-card {
    background: rgba(255, 255, 255, 0.92);
    border-radius: 18px;
    box-shadow: 0 6px 15px rgba(0,0,0,0.1);
  }

  .titulo-seccion {
    color: #2E6362;
    margin-bottom: 20px;
  }

  .texto-intro {
    color: #444;
    margin-bottom: 25px;
  }

  .form-label {
    color: #2E6362;
  }

  .form-control {
    border-radius: 10px;
    border: 1px solid #ccc;
    box-shadow: none;
    padding: 8px 10px;
  }

  .form-control:focus {
    border-color: #6AB7B9;
    box-shadow: 0 0 6px rgba(106,183,185,0.3);
  }

  .btn-hero-calida {
    background-color: #E67E22;
    border: none;
    color: #fff;
    font-weight: 600;
    border-radius: 10px;
    transition: all 0.3s ease, box-shadow 0.3s ease;
  }

  .btn-hero-calida:hover {
    background-color: #CF6916;
    transform: translateY(-2px);
    box-shadow: 0 0 15px rgba(230, 126, 34, 0.6);
  }

  .animate-fade-up {
    opacity: 0;
    transform: translateY(30px);
    animation: fadeUp 0.8s ease-out forwards;
  }

  @keyframes fadeUp {
    to { opacity: 1; transform: translateY(0); }
  }

  @media (max-width: 768px) {
    .testimonios-form-section { padding: 25px 15px; }
  }
</style>

{% endblock %}
